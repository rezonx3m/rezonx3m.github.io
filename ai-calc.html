<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —É—Ä–æ–≤–Ω—è –∫–æ–º–∞–Ω–¥—ã</title>
<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }
  
  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
    padding: 20px;
    color: #333;
  }
  
  .container {
    margin: 0 auto;
    background: white;
    border-radius: 16px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    overflow: hidden;
  }
  
  .header {
    background: #ffffff;
    color: #1e293b;
    padding: 30px 40px;
    border-bottom: 1px solid #e5e7eb;
  }
  
  .mobile-warning {
    display: none;
    background: #fef3c7;
    border: 1px solid #fbbf24;
    color: #92400e;
    padding: 12px 20px;
    border-radius: 8px;
    margin-bottom: 20px;
    font-size: 14px;
    text-align: center;
    font-weight: 500;
  }
  
  @media (max-width: 768px) {
    .mobile-warning {
      display: block;
    }
  }
  
  h1 {
    font-size: 28px;
    font-weight: 700;
    margin-bottom: 8px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
  
  .subtitle {
    font-size: 14px;
    color: #64748b;
  }
  
  .content {
    padding: 30px 40px;
  }
  
  .info-container {
    margin-bottom: 24px;
  }

  .info-toggle {
    background: #f8f9fe;
    border: 2px solid #667eea;
    border-radius: 8px;
    padding: 12px 20px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: space-between;
    transition: all 0.3s ease;
    user-select: none;
  }

  .info-toggle:hover {
    background: #eef1ff;
  }

  .info-toggle-title {
    font-size: 15px;
    font-weight: 600;
    color: #667eea;
  }

  .info-toggle-icon {
    font-size: 18px;
    color: #667eea;
    transition: transform 0.3s ease;
  }

  .info-toggle-icon.open {
    transform: rotate(180deg);
  }

  .info {
    background: #f8f9fe;
    border: none;
    padding: 0 20px;
    border-radius: 0 0 8px 8px;
    font-size: 14px;
    line-height: 1.6;
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease, padding 0.3s ease, border 0.3s ease;
  }

  .info.open {
    max-height: 2000px;
    padding: 16px 20px;
    border: 2px solid #667eea;
    border-top: none;
  }
  
  .info b {
    color: #667eea;
    font-weight: 600;
  }
  
  .info ul {
    margin: 12px 0 0 20px;
  }
  
  .info li {
    margin: 6px 0;
  }
  
  .info ul ul {
    margin-top: 6px;
  }
  
  .controls {
    display: flex;
    gap: 12px;
    margin-bottom: 20px;
    flex-wrap: wrap;
  }
  
  .storage-controls {
    display: flex;
    gap: 12px;
    margin-bottom: 24px;
    flex-wrap: wrap;
  }
  
  .storage-btn {
    background: white;
    color: #667eea;
    border: 2px solid #667eea;
    padding: 10px 20px;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 2px 8px rgba(102, 126, 234, 0.2);
  }
  
  .storage-btn:hover {
    background: #667eea;
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
  }
  
  .storage-btn:active {
    transform: translateY(0);
  }
  
  #fileInput {
    display: none;
  }
  
  .result-box {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 20px 30px;
    border-radius: 12px;
    margin-top: 20px;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
    text-align: center;
    transition: background 0.5s ease, color 0.5s ease;
  }
  
  .result-box .result-label {
    font-size: 14px;
    opacity: 0.9;
    margin-bottom: 8px;
  }
  
  .result-box .result-value {
    font-size: 32px;
    font-weight: 700;
    letter-spacing: 1px;
  }
  
  button {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
  }
  
  button:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
  }
  
  button:active {
    transform: translateY(0);
  }
  
  .table-container {
    display: flex;
    border-radius: 12px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
    overflow: hidden;
    background: white;
  }
  
  .table-left {
    flex-shrink: 0;
    border-right: 2px solid #667eea;
  }
  
  .table-center-wrapper {
    flex-grow: 1;
    overflow-x: auto;
    overflow-y: hidden;
  }
  
  .table-right {
    flex-shrink: 0;
    border-left: 2px solid #667eea;
  }
  
  table {
    border-collapse: collapse;
    background: white;
  }
  
  .table-left table,
  .table-right table {
    width: 100%;
  }
  
  .table-center-wrapper table {
    width: 100%;
    min-width: max-content;
  }
  
  thead {
    background: #667eea;
    color: white;
  }
  
  th {
    padding: 12px 8px;
    text-align: center;
    vertical-align: middle;
    font-weight: 600;
    font-size: 13px;
    border: none;
    white-space: nowrap;
    background: #667eea;
    height: 55px;
    box-sizing: border-box;
  }
  
  .table-left th {
    border-right: 1px solid rgba(255, 255, 255, 0.2);
  }
  
  .table-right th {
    border-left: 1px solid rgba(255, 255, 255, 0.2);
  }
  
  tbody tr {
    transition: background-color 0.2s ease;
  }
  
  tbody tr:nth-child(even) {
    background: #f8f9fe;
  }
  
  tbody tr:hover,
  tbody tr.hover-sync {
    background: #f0f2ff;
  }
  
  td {
    padding: 10px 8px;
    text-align: center;
    vertical-align: middle;
    border: 1px solid #e5e7eb;
    font-size: 13px;
    height: 93px;
    box-sizing: border-box;
  }
  
  .table-left td {
    border-right: none;
  }
  
  .table-center-wrapper td {
    border-left: none;
    border-right: none;
  }
  
  .table-right td {
    border-left: none;
    font-weight: 600;
  }
  
  .col-process {
    width: 180px;
    min-width: 180px;
    white-space: nowrap;
  }
  
  .col-weight {
    width: 70px;
    min-width: 70px;
  }
  
  .col-auto {
    width: 120px;
    min-width: 120px;
  }
  
  .col-result {
    width: 100px;
    min-width: 100px;
  }
  
  input[type="text"] {
    width: 100%;
    max-width: 120px;
    padding: 5px 8px;
    border: 2px solid #e5e7eb;
    border-radius: 6px;
    font-size: 12px;
    transition: all 0.2s ease;
  }
  
  input[type="text"]:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
  }
  
  input[type="number"] {
    width: 50px;
    padding: 6px;
    border: 2px solid #e5e7eb;
    border-radius: 6px;
    font-size: 13px;
    text-align: center;
    transition: all 0.2s ease;
  }
  
  input[type="number"]:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
  }
  
  input[type="number"].empty-weight,
  input[type="text"].empty-name {
    border-color: #fca5a5;
    background-color: #fef2f2;
  }
  
  input[type="number"].empty-weight:focus,
  input[type="text"].empty-name:focus {
    border-color: #ef4444;
    box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
  }
  
  input[type="checkbox"] {
    width: 18px;
    height: 18px;
    cursor: pointer;
    accent-color: #667eea;
  }
  
  .delete-btn {
    background: #ef4444;
    color: white;
    border: none;
    padding: 0;
    border-radius: 4px;
    font-size: 11px;
    cursor: pointer;
    margin-left: 4px;
    transition: all 0.2s ease;
    box-shadow: none;
    line-height: 1;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    vertical-align: middle;
    width: 20px;
    height: 20px;
  }
  
  .delete-btn:hover {
    background: #dc2626;
    transform: scale(1.05);
  }
  
  .slider-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
    padding: 4px;
  }
  
  .slider-row {
    display: flex;
    align-items: center;
    gap: 6px;
  }
  
  .slider-input {
    width: 55px;
    padding: 5px;
    border: 2px solid #e5e7eb;
    border-radius: 6px;
    text-align: center;
    font-size: 13px;
    font-weight: 500;
    transition: all 0.2s ease;
  }
  
  .slider-input:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
  }
  
  input[type="range"] {
    width: 90px;
    height: 6px;
    -webkit-appearance: none;
    appearance: none;
    background: #e5e7eb;
    border-radius: 3px;
    outline: none;
    cursor: pointer;
  }
  
  input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 16px;
    height: 16px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 50%;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 2px 6px rgba(102, 126, 234, 0.4);
  }
  
  input[type="range"]::-webkit-slider-thumb:hover {
    transform: scale(1.2);
  }
  
  input[type="range"]::-moz-range-thumb {
    width: 16px;
    height: 16px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 50%;
    cursor: pointer;
    border: none;
    transition: all 0.2s ease;
    box-shadow: 0 2px 6px rgba(102, 126, 234, 0.4);
  }
  
  input[type="range"]::-moz-range-thumb:hover {
    transform: scale(1.2);
  }
  
  .none-btn {
    background: white;
    color: #667eea;
    border: 2px solid #667eea;
    padding: 4px 10px;
    border-radius: 6px;
    font-size: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: none;
    min-width: 32px;
  }
  
  .none-btn:hover {
    background: #667eea;
    color: white;
    transform: scale(1.05);
  }
  
  .add-employee-header {
    background: #667eea;
    color: white;
    padding: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
    vertical-align: middle;
    min-width: 140px;
  }
  
  .add-employee-header:hover {
    background: #5568d3;
  }
  
  .add-process-row td {
    background: #f8f9fe;
    padding: 12px;
    transition: all 0.3s ease;
    height: 40px;
  }
  
  .add-process-btn {
    color: #667eea;
    font-weight: 600;
    text-align: center;
    cursor: pointer;
  }
  
  .table-left .add-process-row:hover td {
    background: #eef1ff;
  }
  
  .add-employee-column-cell {
    background: transparent !important;
  }
  
  @media (max-width: 768px) {
    body {
      padding: 10px;
    }
    
    .header, .content {
      padding: 20px;
    }
    
    h1 {
      font-size: 22px;
    }
    
    .info {
      font-size: 13px;
      padding: 12px 16px;
    }
    
    th, td {
      padding: 8px 6px;
      font-size: 12px;
    }
  }
</style>
</head>
<body>

<div class="container">
  <div class="header">
    <div class="mobile-warning">
      ‚ö†Ô∏è –î–∞–Ω–Ω—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –Ω–µ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ –º–æ–±–∏–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —à–∏—Ä–æ–∫–∏–µ —ç–∫—Ä–∞–Ω—ã –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.
    </div>
    <h1>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —É—Ä–æ–≤–Ω—è –∑—Ä–µ–ª–æ—Å—Ç–∏ –∫–æ–º–∞–Ω–¥—ã</h1>
    <div class="subtitle">–û—Ü–µ–Ω–∏—Ç–µ –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–∏ –≤–∞—à–µ–π –∫–æ–º–∞–Ω–¥—ã –ø–æ –∫–ª—é—á–µ–≤—ã–º –ø—Ä–æ—Ü–µ—Å—Å–∞–º</div>
  </div>
  
  <div class="content">
    <div class="storage-controls">
      <button class="storage-btn" onclick="exportData()">üì§ –í—ã–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
      <button class="storage-btn" onclick="document.getElementById('fileInput').click()">üì• –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
      <input type="file" id="fileInput" accept=".json" onchange="importData(event)">
    </div>
    
    <div class="info-container">
      <div class="info-toggle" onclick="toggleInfo('info1')">
        <span class="info-toggle-title">üìñ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é</span>
        <span class="info-toggle-icon" id="icon1">‚ñº</span>
      </div>
      <div class="info" id="info1">
        <p><b>–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–æ–º:</b></p>
        <ul>
          <li>–î–æ–±–∞–≤–ª—è–π—Ç–µ <b>–ø—Ä–æ—Ü–µ—Å—Å—ã</b> (–Ω–∞–ø—Ä–∏–º–µ—Ä, ¬´–ö–æ–¥–∏–Ω–≥¬ª, ¬´–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ¬ª) –∏ <b>—Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</b> —Å –ø–æ–º–æ—â—å—é –∫–Ω–æ–ø–æ–∫.</li>
          <li>–î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ —É–∫–∞–∂–∏—Ç–µ –µ–≥–æ <b>–≤–µ—Å</b> (–≤–∞–∂–Ω–æ—Å—Ç—å) –æ—Ç 1 –¥–æ 5.</li>
          <li>–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å —É—á–∞—Å—Ç–∏—è —Å –ø–æ–º–æ—â—å—é <b>–ø–æ–ª–∑—É–Ω–∫–∞</b>:
            <ul>
              <li><b>‚Äì</b> ‚Äî –Ω–µ —É—á–∞—Å—Ç–≤—É–µ—Ç</li>
              <li><b>0</b> ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å</li>
              <li><b>1</b> ‚Äî –±–∞–∑–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å</li>
              <li><b>2</b> ‚Äî –≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å</li>
            </ul>
            –ú–æ–∂–Ω–æ —Ç–∞–∫–∂–µ –≤–≤–µ—Å—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –≤—Ä—É—á–Ω—É—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, 1.5).
          </li>
          <li>–ï—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å <b>–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω</b>, –ø–æ—Å—Ç–∞–≤—å—Ç–µ –≥–∞–ª–æ—á–∫—É ‚Äî —Ç–æ–≥–¥–∞ —É—Ä–æ–≤–µ–Ω—å —Å—á–∏—Ç–∞–µ—Ç—Å—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º (2), –∞ –≤–∫–ª–∞–¥ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è.</li>
          <li>–í–Ω–∏–∑—É –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è <b>–æ–±—â–∏–π —É—Ä–æ–≤–µ–Ω—å –∫–æ–º–∞–Ω–¥—ã</b>.</li>
          <li><b>üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:</b> –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ (localStorage). –û–¥–Ω–∞–∫–æ, —á—Ç–æ–±—ã –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ –∫—ç—à–∞ –∏–ª–∏ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–µ –±—Ä–∞—É–∑–µ—Ä–∞, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –≤—ã–≥—Ä—É–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ JSON-—Ñ–∞–π–ª —Å –ø–æ–º–æ—â—å—é –∫–Ω–æ–ø–∫–∏ "–í—ã–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ".</li>
        </ul>
        
        <p style="margin-top: 16px;"><b>–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç ¬´–ü—Ä–æ—Ü–µ—Å—Å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω¬ª?</b></p>
        <p>
          –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –Ω–∞–ø—Ä—è–º—É—é –æ—Ç —É—Ä–æ–≤–Ω—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞.  
          –ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ —Ä–µ–≤—å—é –∫–æ–¥–∞ –∞–≥–µ–Ω—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, <i>pr-agent</i>) –º–æ–∂–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å PR –∏ –≤—ã–¥–∞–≤–∞—Ç—å –∑–∞–º–µ—á–∞–Ω–∏—è.  
          –¢–æ–≥–¥–∞ –ø—Ä–æ—Ü–µ—Å—Å —Å—á–∏—Ç–∞–µ—Ç—Å—è <b>–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º</b>, —Ö–æ—Ç—è –∫–æ–º–∞–Ω–¥–∞ –≤—Å—ë —Ä–∞–≤–Ω–æ –º–æ–∂–µ—Ç –¥–µ–ª–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Ä–µ–≤—å—é –≤—Ä—É—á–Ω—É—é.
        </p>
        
        <p style="margin-top: 16px;"><b>–ü–æ—á–µ–º—É –æ–±—â–∏–π —É—Ä–æ–≤–µ–Ω—å –∫–æ–º–∞–Ω–¥—ã ‚Äî —ç—Ç–æ –Ω–µ ¬´—Å—Ä–µ–¥–Ω–µ–µ –ø–æ –±–æ–ª—å–Ω–∏—Ü–µ¬ª?</b></p>
        <p>
          –û–±—â–∏–π —É—Ä–æ–≤–µ–Ω—å –∫–æ–º–∞–Ω–¥—ã —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ <b>–≤–∑–≤–µ—à–µ–Ω–Ω–æ–µ —Å—Ä–µ–¥–Ω–µ–µ</b>, –≥–¥–µ –≤–µ—Å –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ—Ç—Ä–∞–∂–∞–µ—Ç –µ–≥–æ –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–µ–π –ø—Ä–æ–µ–∫—Ç–∞.  
          –ü—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–µ –≤–µ—Å–æ–≤ –∏—Ç–æ–≥–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è <b>–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–º –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–º</b>:
        </p>
        <ul>
          <li>–ï—Å–ª–∏ –¥–ª—è –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –∫—Ä–∏—Ç–∏—á–Ω—ã –∫–æ–¥-—Ä–µ–≤—å—é –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –∏–º —Å—Ç–æ–∏—Ç –Ω–∞–∑–Ω–∞—á–∏—Ç—å –≤—ã—Å–æ–∫–∏–π –≤–µ—Å (4‚Äì5).</li>
          <li>–ú–µ–Ω–µ–µ –≤–∞–∂–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ MVP-–ø—Ä–æ–µ–∫—Ç–∞—Ö) –º–æ–≥—É—Ç –∏–º–µ—Ç—å –Ω–∏–∑–∫–∏–π –≤–µ—Å (1‚Äì2).</li>
          <li>–ò—Ç–æ–≥–æ–≤—ã–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –æ—Ç—Ä–∞–∂–∞–µ—Ç <b>—Ä–µ–∞–ª—å–Ω—É—é –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫–æ–º–∞–Ω–¥—ã</b> —Ä–∞–±–æ—Ç–∞—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –≤–∞—à–∏—Ö –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤, –∞ –Ω–µ —É—Å—Ä–µ–¥–Ω—ë–Ω–Ω—É—é –æ—Ü–µ–Ω–∫—É –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.</li>
        </ul>
        <p>
          –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –∫–æ–º–∞–Ω–¥–∞ –º–æ–∂–µ—Ç <b>–æ–ø–∏—Ä–∞—Ç—å—Å—è –Ω–∞ —ç—Ç–æ—Ç –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å</b> –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π: 
          –∫–∞–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã —Ç—Ä–µ–±—É—é—Ç —É—Å–∏–ª–µ–Ω–∏—è, –≥–¥–µ –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∏–ª–∏ –æ–±—É—á–µ–Ω–∏—è, –∏ –Ω–∞—Å–∫–æ–ª—å–∫–æ –∫–æ–º–∞–Ω–¥–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ç–µ–∫—É—â–∏–º –≤—ã–∑–æ–≤–∞–º.
        </p>
      </div>
    </div>


    <div class="table-container">
      <div class="table-left">
        <table id="leftTable">
          <thead>
            <tr>
              <th class="col-process">–ü—Ä–æ—Ü–µ—Å—Å</th>
              <th class="col-weight">–í–µ—Å<br>(1‚Äì5)</th>
              <th class="col-auto" title="–ü—Ä–æ—Ü–µ—Å—Å –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤">–ü—Ä–æ—Ü–µ—Å—Å<br>–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä.</th>
            </tr>
          </thead>
          <tbody id="leftBody"></tbody>
        </table>
      </div>
      
      <div class="table-center-wrapper" id="centerWrapper">
        <table id="centerTable">
          <thead>
            <tr id="centerHeader">
              <!-- –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —Å—é–¥–∞ -->
            </tr>
          </thead>
          <tbody id="centerBody"></tbody>
        </table>
      </div>
      
      <div class="table-right">
        <table id="rightTable">
          <thead>
            <tr>
              <th class="col-result">–£—Ä–æ–≤–µ–Ω—å<br>–ø—Ä–æ—Ü–µ—Å—Å–∞</th>
            </tr>
          </thead>
          <tbody id="rightBody"></tbody>
        </table>
      </div>
    </div>
    
    <div class="result-box">
      <div class="result-label">–û–±—â–∏–π —É—Ä–æ–≤–µ–Ω—å –∑—Ä–µ–ª–æ—Å—Ç–∏ –∫–æ–º–∞–Ω–¥—ã</div>
      <div class="result-value" id="overallResult">0.00</div>
    </div>
  </div>
</div>

<script>
const levels = { "0": 0, "1": 1, "2": 2, "-": null };
const defaultProcesses = ["–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–¥–µ–π, –¢–ó", "–ö–æ–¥–∏–Ω–≥", "–†–µ–≤—å—é (PR/MR)", "–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ", "–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ"];
const defaultEmployees = ["–ò–≤–∞–Ω–æ–≤", "–ü–µ—Ç—Ä–æ–≤", "–°–∏–¥–æ—Ä–æ–≤", "–°–º–∏—Ä–Ω–æ–≤", "–ö—É–∑–Ω–µ—Ü–æ–≤", "–ü–æ–ø–æ–≤"];

let rowIndex = 0; // –°—á—ë—Ç—á–∏–∫ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å—Ç—Ä–æ–∫

// ===== –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è localStorage =====
function setLocalStorage(name, value) {
  try {
    localStorage.setItem(name, JSON.stringify(value));
  } catch (e) {
    console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ localStorage:', e);
  }
}
function getLocalStorage(name) {
  try {
    const item = localStorage.getItem(name);
    return item ? JSON.parse(item) : null;
  } catch (e) {
    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ localStorage:', e);
    return null;
  }
}

// ===== –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è hover —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏ =====
function syncHoverEffects() {
  const leftRows = document.querySelectorAll("#leftBody tr");
  const centerRows = document.querySelectorAll("#centerBody tr");
  const rightRows = document.querySelectorAll("#rightBody tr");

  [leftRows, centerRows, rightRows].forEach(rows => {
    rows.forEach((row, index) => {
      row.addEventListener("mouseenter", () => {
        leftRows[index]?.classList.add("hover-sync");
        centerRows[index]?.classList.add("hover-sync");
        rightRows[index]?.classList.add("hover-sync");
      });
      row.addEventListener("mouseleave", () => {
        leftRows[index]?.classList.remove("hover-sync");
        centerRows[index]?.classList.remove("hover-sync");
        rightRows[index]?.classList.remove("hover-sync");
      });
    });
  });
}

// ===== –≠–ª–µ–º–µ–Ω—Ç —É—Ä–æ–≤–Ω—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ =====
function createLevelCell(auto = false, initialValue = "-") {
  const cell = document.createElement("td");
  const container = document.createElement("div");
  container.className = "slider-container";

  const sliderRow = document.createElement("div");
  sliderRow.className = "slider-row";

  const noneBtn = document.createElement("button");
  noneBtn.textContent = "‚Äì";
  noneBtn.className = "none-btn";

  const range = document.createElement("input");
  range.type = "range";
  range.min = 0;
  range.max = 2;
  range.step = 0.1;
  range.value = initialValue === "-" ? 0 : initialValue;
  range.disabled = auto;

  const numberInput = document.createElement("input");
  numberInput.type = "number";
  numberInput.min = 0;
  numberInput.max = 2;
  numberInput.step = 0.1;
  numberInput.className = "slider-input";
  numberInput.value = initialValue === "-" ? "" : initialValue;

  // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—É—é –ø–æ–¥—Å–≤–µ—Ç–∫—É –∫–Ω–æ–ø–∫–∏ "‚Äì"
  if (initialValue === "-") {
    noneBtn.style.background = "#eee";
  }

  function updateFromRange() {
    numberInput.value = range.value;
    noneBtn.style.background = "";
    calculate(); saveTableToStorage();
  }

  function updateFromNumber() {
    // –ï—Å–ª–∏ –ø–æ–ª–µ –ø—É—Å—Ç–æ–µ, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º "‚Äì"
    if (numberInput.value === "" || numberInput.value.trim() === "") {
      setNone();
      return;
    }
    
    let val = parseFloat(numberInput.value);
    if (!isNaN(val)) {
      // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º –æ—Ç 0 –¥–æ 2
      if (val < 0) val = 0;
      if (val > 2) val = 2;
      numberInput.value = val;
      range.value = val;
      noneBtn.style.background = "";
      calculate(); saveTableToStorage();
    }
  }

  function setNone() {
    numberInput.value = "";
    range.value = 0;
    noneBtn.style.background = "#eee";
    calculate(); saveTableToStorage();
  }

  range.addEventListener("input", updateFromRange);
  numberInput.addEventListener("input", updateFromNumber);
  noneBtn.addEventListener("click", setNone);

  sliderRow.append(noneBtn, range);
  container.append(numberInput, sliderRow);
  cell.appendChild(container);
  return cell;
}

// ===== –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–µ—Å–∞ =====
function validateWeightInput(input) {
  if (!input.value || input.value === "" || parseFloat(input.value) < 1) {
    input.classList.add("empty-weight");
  } else {
    input.classList.remove("empty-weight");
  }
}

// ===== –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–º–µ–Ω–∏ =====
function validateNameInput(input) {
  if (!input.value || input.value.trim() === "") {
    input.classList.add("empty-name");
  } else {
    input.classList.remove("empty-name");
  }
}

// ===== –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ =====
function updateAddProcessRow() {
  const centerHeader = document.getElementById("centerHeader");
  const employeeCount = centerHeader.querySelectorAll("th:not(.add-employee-header)").length;
  
  // –õ–µ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞
  let leftAddRow = document.querySelector("#leftBody tr.add-process-row");
  if (!leftAddRow) {
    leftAddRow = document.createElement("tr");
    leftAddRow.className = "add-process-row";
    
    const cell = document.createElement("td");
    cell.className = "add-process-btn";
    cell.colSpan = 3;
    cell.textContent = "+ –î–æ–±–∞–≤–∏—Ç—å";
    cell.onclick = () => addProcess();
    
    leftAddRow.appendChild(cell);
    document.getElementById("leftBody").appendChild(leftAddRow);
  }
  
  // –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞
  let centerAddRow = document.querySelector("#centerBody tr.add-process-row");
  const hasAddButton = document.querySelector('#centerHeader .add-employee-header');
  
  if (!centerAddRow) {
    centerAddRow = document.createElement("tr");
    centerAddRow.className = "add-process-row";
    
    const cell = document.createElement("td");
    cell.className = "add-process-btn";
    cell.textContent = "";
    cell.style.background = "transparent";
    cell.style.cursor = "default";
    centerAddRow.appendChild(cell);
    
    // –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Å—Ç—É—é —è—á–µ–π–∫—É –¥–ª—è –∫–æ–ª–æ–Ω–∫–∏ "–î–æ–±–∞–≤–∏—Ç—å", –µ—Å–ª–∏ –∫–Ω–æ–ø–∫–∞ –µ—Å—Ç—å
    if (hasAddButton) {
      const emptyCell = document.createElement("td");
      emptyCell.className = "add-employee-column-cell";
      centerAddRow.appendChild(emptyCell);
    }
    
    document.getElementById("centerBody").appendChild(centerAddRow);
  }
  
  // –û–±–Ω–æ–≤–ª—è–µ–º colspan –≤ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ
  const centerCell = centerAddRow.children[0];
  centerCell.colSpan = Math.max(1, employeeCount);
  
  // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—É—Å—Ç—ã—Ö —è—á–µ–µ–∫
  const currentEmptyCells = centerAddRow.querySelectorAll('td:not(.add-process-btn)').length;
  if (hasAddButton && currentEmptyCells === 0) {
    const emptyCell = document.createElement("td");
    emptyCell.className = "add-employee-column-cell";
    centerAddRow.appendChild(emptyCell);
  } else if (!hasAddButton && currentEmptyCells > 0) {
    centerAddRow.querySelectorAll('td:not(.add-process-btn)').forEach(cell => cell.remove());
  }
  
  // –ü—Ä–∞–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞
  let rightAddRow = document.querySelector("#rightBody tr.add-process-row");
  if (!rightAddRow) {
    rightAddRow = document.createElement("tr");
    rightAddRow.className = "add-process-row";
    
    const cell = document.createElement("td");
    cell.style.background = "transparent";
    cell.textContent = "";
    
    rightAddRow.appendChild(cell);
    document.getElementById("rightBody").appendChild(rightAddRow);
  }
}

// ===== –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ =====
function initAddEmployeeButton() {
  const centerHeader = document.getElementById("centerHeader");
  
  // –£–±–∏—Ä–∞–µ–º —Å—Ç–∞—Ä—É—é –∫–Ω–æ–ø–∫—É, –µ—Å–ª–∏ –µ—Å—Ç—å
  const oldBtn = centerHeader.querySelector('.add-employee-header');
  if (oldBtn) {
    oldBtn.remove();
  }
  
  // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É
  const addEmployeeHeader = document.createElement("th");
  addEmployeeHeader.className = "add-employee-header";
  addEmployeeHeader.textContent = "+ –î–æ–±–∞–≤–∏—Ç—å";
  addEmployeeHeader.onclick = () => addEmployee();
  centerHeader.appendChild(addEmployeeHeader);
  
  // –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Å—Ç—ã–µ —è—á–µ–π–∫–∏ –¥–ª—è –∫–æ–ª–æ–Ω–∫–∏ "–î–æ–±–∞–≤–∏—Ç—å" –≤–æ –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ç—Ä–æ–∫–∏, –µ—Å–ª–∏ –∏—Ö –µ—â–µ –Ω–µ—Ç
  const employeeCount = centerHeader.querySelectorAll("th:not(.add-employee-header)").length;
  document.querySelectorAll("#centerBody tr:not(.add-process-row)").forEach(row => {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω—É–∂–Ω–æ –ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –ø—É—Å—Ç—É—é —è—á–µ–π–∫—É (–µ—Å–ª–∏ —è—á–µ–µ–∫ –º–µ–Ω—å—à–µ, —á–µ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ + 1)
    if (row.children.length === employeeCount) {
      const emptyCell = document.createElement("td");
      emptyCell.className = "add-employee-column-cell";
      row.appendChild(emptyCell);
    }
  });
}

// ===== –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ =====
function addProcess(name = "") {
  const currentIndex = rowIndex++;
  
  // –£–±–∏—Ä–∞–µ–º —Å—Ç—Ä–æ–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞, –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å
  document.querySelectorAll("tr.add-process-row").forEach(row => row.remove());
  
  // –õ–µ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ (–ü—Ä–æ—Ü–µ—Å—Å, –í–µ—Å, –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è)
  const leftRow = document.createElement("tr");
  leftRow.dataset.rowIndex = currentIndex;

  // –ü—Ä–æ—Ü–µ—Å—Å
  const processCell = document.createElement("td");
  processCell.className = "col-process";
  const processInput = document.createElement("input");
  processInput.type = "text";
  processInput.value = name;
  
  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –Ω–∞–∑–≤–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞
  processInput.addEventListener("input", () => {
    validateNameInput(processInput);
    saveTableToStorage();
  });
  processInput.addEventListener("blur", () => {
    validateNameInput(processInput);
  });
  
  processCell.appendChild(processInput);

  const delBtn = document.createElement("button");
  delBtn.textContent = "‚úñ";
  delBtn.className = "delete-btn";
  delBtn.onclick = () => { removeProcess(currentIndex); };
  processCell.appendChild(delBtn);
  leftRow.appendChild(processCell);

  // –í–µ—Å
  const weightCell = document.createElement("td");
  weightCell.className = "col-weight";
  const weightInput = document.createElement("input");
  weightInput.type = "number";
  weightInput.min = 1;
  weightInput.max = 5;
  weightInput.value = 1;
  weightInput.addEventListener("input", () => { 
    validateWeightInput(weightInput);
    calculate(); 
    saveTableToStorage();
  });
  weightInput.addEventListener("blur", () => {
    validateWeightInput(weightInput);
  });
  weightCell.appendChild(weightInput);
  leftRow.appendChild(weightCell);

  // –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
  const autoCell = document.createElement("td");
  autoCell.className = "col-auto";
  const autoCheckbox = document.createElement("input");
  autoCheckbox.type = "checkbox";
  autoCheckbox.addEventListener("change", () => {
    const centerRow = document.querySelector(`#centerBody tr[data-row-index="${currentIndex}"]`);
    if (centerRow) {
      centerRow.querySelectorAll("input").forEach(inp => inp.disabled = autoCheckbox.checked);
    }
    calculate(); saveTableToStorage();
  });
  autoCell.appendChild(autoCheckbox);
  leftRow.appendChild(autoCell);

  document.getElementById("leftBody").appendChild(leftRow);

  // –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ (–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏)
  const centerRow = document.createElement("tr");
  centerRow.dataset.rowIndex = currentIndex;
  const centerHeader = document.getElementById("centerHeader");
  const employeeCount = centerHeader.querySelectorAll("th:not(.add-employee-header)").length;
  for (let i = 0; i < employeeCount; i++) {
    const cell = createLevelCell(autoCheckbox.checked, "-");
    centerRow.appendChild(cell);
  }
  
  // –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Å—Ç—É—é —è—á–µ–π–∫—É –¥–ª—è –∫–æ–ª–æ–Ω–∫–∏ "–î–æ–±–∞–≤–∏—Ç—å"
  if (centerHeader.querySelector('.add-employee-header')) {
    const emptyCell = document.createElement("td");
    emptyCell.className = "add-employee-column-cell";
    centerRow.appendChild(emptyCell);
  }
  
  document.getElementById("centerBody").appendChild(centerRow);

  // –ü—Ä–∞–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ (–ò—Ç–æ–≥)
  const rightRow = document.createElement("tr");
  rightRow.dataset.rowIndex = currentIndex;
  const resultCell = document.createElement("td");
  resultCell.className = "col-result";
  resultCell.textContent = "0";
  rightRow.appendChild(resultCell);
  document.getElementById("rightBody").appendChild(rightRow);

  // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä–æ–∫—É —Å –∫–Ω–æ–ø–∫–æ–π –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞
  updateAddProcessRow();

  syncHoverEffects();
  calculate();
  saveTableToStorage();
}

function removeProcess(index) {
  document.querySelector(`#leftBody tr[data-row-index="${index}"]`)?.remove();
  document.querySelector(`#centerBody tr[data-row-index="${index}"]`)?.remove();
  document.querySelector(`#rightBody tr[data-row-index="${index}"]`)?.remove();
  syncHoverEffects();
  calculate();
  saveTableToStorage();
}

function addEmployee(name = "") {
  const centerHeader = document.getElementById("centerHeader");
  
  // –£–±–∏—Ä–∞–µ–º –∫–Ω–æ–ø–∫—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–∞ –µ—Å—Ç—å
  const addBtn = centerHeader.querySelector('.add-employee-header');
  if (addBtn) {
    addBtn.remove();
  }
  
  const th = document.createElement("th");
  const input = document.createElement("input");
  input.type = "text";
  input.value = name;
  input.placeholder = "–§–ò–û";
  
  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –§–ò–û
  input.addEventListener("input", () => {
    validateNameInput(input);
    saveTableToStorage();
  });
  input.addEventListener("blur", () => {
    validateNameInput(input);
  });

  const delBtn = document.createElement("button");
  delBtn.textContent = "‚úñ";
  delBtn.className = "delete-btn";
  delBtn.onclick = () => { removeEmployee(th.cellIndex); };

  th.append(input, delBtn);
  centerHeader.appendChild(th);

  // –î–æ–±–∞–≤–ª—è–µ–º —è—á–µ–π–∫—É –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ü–ï–†–ï–î –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø—É—Å—Ç–æ–π —è—á–µ–π–∫–æ–π
  document.querySelectorAll("#centerBody tr:not(.add-process-row)").forEach((row, idx) => {
    const leftRow = document.querySelectorAll("#leftBody tr:not(.add-process-row)")[idx];
    const auto = leftRow ? leftRow.children[2].firstChild.checked : false;
    const cell = createLevelCell(auto, "-");
    
    // –ù–∞—Ö–æ–¥–∏–º –ø–æ—Å–ª–µ–¥–Ω—é—é —è—á–µ–π–∫—É (–ø—É—Å—Ç—É—é –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–î–æ–±–∞–≤–∏—Ç—å")
    const lastCell = row.querySelector('.add-employee-column-cell');
    if (lastCell) {
      // –í—Å—Ç–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é —è—á–µ–π–∫—É –ø–µ—Ä–µ–¥ –ø—É—Å—Ç–æ–π
      row.insertBefore(cell, lastCell);
    } else {
      // –ï—Å–ª–∏ –ø—É—Å—Ç–æ–π —è—á–µ–π–∫–∏ –Ω–µ—Ç, –¥–æ–±–∞–≤–ª—è–µ–º –≤ –∫–æ–Ω–µ—Ü
      row.appendChild(cell);
    }
  });
  
  // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –≤ –∫–æ–Ω–µ—Ü
  const addEmployeeHeader = document.createElement("th");
  addEmployeeHeader.className = "add-employee-header";
  addEmployeeHeader.textContent = "+ –î–æ–±–∞–≤–∏—Ç—å";
  addEmployeeHeader.onclick = () => addEmployee();
  centerHeader.appendChild(addEmployeeHeader);
  
  // –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Å—Ç—ã–µ —è—á–µ–π–∫–∏ –¥–ª—è –∫–æ–ª–æ–Ω–∫–∏ "–î–æ–±–∞–≤–∏—Ç—å" –≤–æ –≤—Å–µ —Å—Ç—Ä–æ–∫–∏, –µ—Å–ª–∏ –∏—Ö –µ—â–µ –Ω–µ—Ç
  document.querySelectorAll("#centerBody tr:not(.add-process-row)").forEach(row => {
    if (!row.querySelector('.add-employee-column-cell')) {
      const emptyCell = document.createElement("td");
      emptyCell.className = "add-employee-column-cell";
      row.appendChild(emptyCell);
    }
  });
  
  // –û–±–Ω–æ–≤–ª—è–µ–º colspan –≤ —Å—Ç—Ä–æ–∫–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞
  updateAddProcessRow();

  saveTableToStorage();
  calculate();
}

function removeEmployee(index) {
  const centerHeader = document.getElementById("centerHeader");
  centerHeader.removeChild(centerHeader.children[index]);
  document.querySelectorAll("#centerBody tr:not(.add-process-row)").forEach(row => {
    row.removeChild(row.children[index]);
  });
  
  // –û–±–Ω–æ–≤–ª—è–µ–º colspan –≤ —Å—Ç—Ä–æ–∫–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞
  updateAddProcessRow();
  
  calculate();
  saveTableToStorage();
}

// ===== –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ü–≤–µ—Ç–∞ —Ñ–æ–Ω–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Ä–æ–≤–Ω—è =====
function getBackgroundForLevel(level) {
  const value = parseFloat(level);
  
  if (value >= 2) {
    // 2 –∏ –≤—ã—à–µ - –∑–µ–ª–µ–Ω—ã–π —Ü–≤–µ—Ç
    return '#10b981';
  } else if (value >= 1) {
    // –û—Ç 1 –¥–æ 2: –ø–ª–∞–≤–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –æ—Ç –∂–µ–ª—Ç–æ–≥–æ –∫ –∑–µ–ª–µ–Ω–æ–º—É
    const ratio = value - 1; // 0..1
    const r = Math.round(255 - (255 - 16) * ratio);    // –æ—Ç 255 (–∂–µ–ª—Ç—ã–π) –¥–æ 16 (–∑–µ–ª–µ–Ω—ã–π)
    const g = Math.round(217 - (217 - 185) * ratio);   // –æ—Ç 217 (–∂–µ–ª—Ç—ã–π) –¥–æ 185 (–∑–µ–ª–µ–Ω—ã–π)
    const b = Math.round(61 + (129 - 61) * ratio);     // –æ—Ç 61 (–∂–µ–ª—Ç—ã–π) –¥–æ 129 (–∑–µ–ª–µ–Ω—ã–π)
    return `rgb(${r}, ${g}, ${b})`;
  } else {
    // –û—Ç 0 –¥–æ 1: –ø–ª–∞–≤–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –æ—Ç –∫—Ä–∞—Å–Ω–æ–≥–æ –∫ –∂–µ–ª—Ç–æ–º—É
    const ratio = value; // 0..1
    const r = Math.round(255 - (255 - 255) * ratio);   // –æ—Ç 255 (–∫—Ä–∞—Å–Ω—ã–π) –¥–æ 255 (–∂–µ–ª—Ç—ã–π)
    const g = Math.round(107 + (217 - 107) * ratio);   // –æ—Ç 107 (–∫—Ä–∞—Å–Ω—ã–π) –¥–æ 217 (–∂–µ–ª—Ç—ã–π)
    const b = Math.round(107 - (107 - 61) * ratio);    // –æ—Ç 107 (–∫—Ä–∞—Å–Ω—ã–π) –¥–æ 61 (–∂–µ–ª—Ç—ã–π)
    return `rgb(${r}, ${g}, ${b})`;
  }
}

// ===== –†–∞—Å—á—ë—Ç =====
function calculate() {
  const leftRows = document.querySelectorAll("#leftBody tr:not(.add-process-row)");
  const centerRows = document.querySelectorAll("#centerBody tr:not(.add-process-row)");
  const rightRows = document.querySelectorAll("#rightBody tr:not(.add-process-row)");
  
  let totalWeighted = 0, totalWeight = 0;

  leftRows.forEach((leftRow, idx) => {
    const weightInput = leftRow.children[1].firstChild;
    const weight = parseFloat(weightInput.value) || 1;
    validateWeightInput(weightInput);
    const auto = leftRow.children[2].firstChild.checked;
    let processLevel = 0;

    if (auto) {
      processLevel = 2;
    } else {
      const centerRow = centerRows[idx];
      if (centerRow) {
        let sum = 0, count = 0;
        centerRow.querySelectorAll('input[type="number"]').forEach(numberInput => {
          if (numberInput.value !== "") {
            const val = parseFloat(numberInput.value);
            if (!isNaN(val)) { sum += val; count++; }
          }
        });
        processLevel = count > 0 ? sum / count : 0;
      }
    }
    
    if (rightRows[idx]) {
      rightRows[idx].firstChild.textContent = processLevel.toFixed(2);
    }
    
    totalWeighted += processLevel * weight;
    totalWeight += weight;
  });

  const overall = totalWeight > 0 ? (totalWeighted / totalWeight).toFixed(2) : "0.00";
  document.getElementById("overallResult").textContent = overall;
  
  // –û–±–Ω–æ–≤–ª—è–µ–º —Ñ–æ–Ω –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Ä–æ–≤–Ω—è
  const resultBox = document.querySelector(".result-box");
  resultBox.style.background = getBackgroundForLevel(overall);
  
  // –ò–∑–º–µ–Ω—è–µ–º —Ü–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —è—Ä–∫–æ—Å—Ç–∏ —Ñ–æ–Ω–∞
  const value = parseFloat(overall);
  if (value < 1.5) {
    // –î–ª—è –∫—Ä–∞—Å–Ω–æ–≥–æ –∏ –∂–µ–ª—Ç–æ–≥–æ —Ñ–æ–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ–º–Ω—ã–π —Ç–µ–∫—Å—Ç
    resultBox.style.color = "#1e293b";
  } else {
    // –î–ª—è –∑–µ–ª–µ–Ω–æ–≥–æ –∏ —Ä–∞–¥—É–∂–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º –±–µ–ª—ã–π —Ç–µ–∫—Å—Ç
    resultBox.style.color = "white";
  }
}

// ===== –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ =====
function saveTableToStorage() {
  const processes = [];
  const leftRows = document.querySelectorAll("#leftBody tr:not(.add-process-row)");
  const centerRows = document.querySelectorAll("#centerBody tr:not(.add-process-row)");

  leftRows.forEach((leftRow, idx) => {
    const p = {
      name: leftRow.children[0].firstChild.value,
      weight: leftRow.children[1].firstChild.value,
      auto: leftRow.children[2].firstChild.checked,
      levels: []
    };
    
    const centerRow = centerRows[idx];
    if (centerRow) {
      centerRow.querySelectorAll('input[type="number"]').forEach(numberInput => {
        const valText = numberInput.value !== "" ? numberInput.value : "‚Äì";
        p.levels.push(valText);
      });
    }
    
    processes.push(p);
  });

  const employees = [];
  const centerHeader = document.getElementById("centerHeader");
  centerHeader.querySelectorAll("th:not(.add-employee-header)").forEach(th => {
    employees.push(th.firstChild.value);
  });

  setLocalStorage('processes', processes);
  setLocalStorage('employees', employees);
}

function loadTableFromStorage() {
  const savedEmployees = getLocalStorage('employees');
  const savedProcesses = getLocalStorage('processes');

  // –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  const hasData = savedEmployees || savedProcesses;

  // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
  if (savedEmployees && savedEmployees.length > 0) {
    savedEmployees.forEach(name => addEmployee(name));
  } else if (!hasData) {
    defaultEmployees.forEach(name => addEmployee(name));
  } else {
    // –ï—Å–ª–∏ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, –Ω–æ –µ—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã, –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É
    initAddEmployeeButton();
  }

  // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å—ã
  if (savedProcesses && savedProcesses.length > 0) {
    document.getElementById("leftBody").innerHTML = '';
    document.getElementById("centerBody").innerHTML = '';
    document.getElementById("rightBody").innerHTML = '';
    rowIndex = 0;
    
    savedProcesses.forEach(p => {
      addProcess(p.name);
      
      const leftRows = document.querySelectorAll("#leftBody tr:not(.add-process-row)");
      const centerRows = document.querySelectorAll("#centerBody tr:not(.add-process-row)");
      const lastLeftRow = leftRows[leftRows.length - 1];
      const lastCenterRow = centerRows[centerRows.length - 1];
      
      if (lastLeftRow) {
        const processInput = lastLeftRow.children[0].firstChild;
        validateNameInput(processInput);
        const weightInput = lastLeftRow.children[1].firstChild;
        weightInput.value = p.weight;
        validateWeightInput(weightInput);
        lastLeftRow.children[2].firstChild.checked = p.auto;
      }
      
      if (lastCenterRow) {
        const cells = lastCenterRow.querySelectorAll("td");
        for (let i = 0; i < p.levels.length && i < cells.length; i++) {
          const cell = cells[i];
          const val = p.levels[i];
          const range = cell.querySelector('input[type="range"]');
          const number = cell.querySelector('input[type="number"]');
          const noneBtn = cell.querySelector('.none-btn');
          
          if (val === "‚Äì") {
            number.value = "";
            range.value = 0;
            if (noneBtn) noneBtn.style.background = "#eee";
          } else {
            range.value = val;
            number.value = val;
            if (noneBtn) noneBtn.style.background = "";
          }
          cell.querySelectorAll("input").forEach(inp => inp.disabled = p.auto);
        }
      }
    });
  } else if (!hasData) {
    defaultProcesses.forEach(name => addProcess(name));
  }

  // –í–∞–ª–∏–¥–∏—Ä—É–µ–º –≤—Å–µ –∏–º–µ–Ω–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
  document.querySelectorAll("#centerHeader input[type='text']").forEach(input => {
    validateNameInput(input);
  });

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞, –µ—Å–ª–∏ –µ–µ –µ—â–µ –Ω–µ—Ç
  if (!document.querySelector('.add-employee-header')) {
    initAddEmployeeButton();
  }
  
  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ç—Ä–æ–∫—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞, –µ—Å–ª–∏ –µ–µ –µ—â–µ –Ω–µ—Ç
  if (!document.querySelector('.add-process-row')) {
    updateAddProcessRow();
  }

  calculate();
}

// ===== –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –±–ª–æ–∫–∞ =====
function toggleInfo(id) {
  const infoBlock = document.getElementById(id);
  const icon = document.getElementById('icon1');
  
  if (infoBlock.classList.contains('open')) {
    infoBlock.classList.remove('open');
    icon.classList.remove('open');
  } else {
    infoBlock.classList.add('open');
    icon.classList.add('open');
  }
}

// ===== –≠–∫—Å–ø–æ—Ä—Ç –∏ –∏–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö =====
function exportData() {
  const employees = getLocalStorage('employees') || [];
  const processes = getLocalStorage('processes') || [];
  
  const data = {
    version: "1.0",
    exportDate: new Date().toISOString(),
    employees: employees,
    processes: processes
  };
  
  // –°–æ–∑–¥–∞–µ–º blob —Å JSON –¥–∞–Ω–Ω—ã–º–∏
  const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  
  // –°–æ–∑–¥–∞–µ–º —Å—Å—ã–ª–∫—É –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
  const a = document.createElement('a');
  a.href = url;
  a.download = `team-maturity-${new Date().toISOString().split('T')[0]}.json`;
  document.body.appendChild(a);
  a.click();
  
  // –û—á–∏—â–∞–µ–º
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
  
  alert('‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –≤—ã–≥—Ä—É–∂–µ–Ω—ã!');
}

function importData(event) {
  const file = event.target.files[0];
  if (!file) return;
  
  const reader = new FileReader();
  reader.onload = function(e) {
    try {
      const data = JSON.parse(e.target.result);
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö
      if (!data.employees || !data.processes) {
        throw new Error('–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞');
      }
      
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ localStorage
      setLocalStorage('employees', data.employees);
      setLocalStorage('processes', data.processes);
      
      // –û—á–∏—â–∞–µ–º —Ç–∞–±–ª–∏—Ü—ã
      document.getElementById("leftBody").innerHTML = '';
      document.getElementById("centerBody").innerHTML = '';
      document.getElementById("rightBody").innerHTML = '';
      document.getElementById("centerHeader").innerHTML = '';
      rowIndex = 0;
      
      // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Ç–∞–±–ª–∏—Ü—É
      loadTableFromStorage();
      
      alert('‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã!');
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞:', error);
      alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç.');
    }
  };
  
  reader.onerror = function() {
    alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞.');
  };
  
  reader.readAsText(file);
  
  // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ input, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ç–æ—Ç –∂–µ —Ñ–∞–π–ª –ø–æ–≤—Ç–æ—Ä–Ω–æ
  event.target.value = '';
}

// ===== –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è =====
loadTableFromStorage();
</script>

</body>
</html>
